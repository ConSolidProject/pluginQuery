(self.webpackChunkprojectquery=self.webpackChunkprojectquery||[]).push([[762],{31762:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>J});var r=n(77865),a=n.n(r),l=n(21704),o=n.n(l),c=n(85061),s=n(92137),i=n(28481),u=n(87757),d=n.n(u),f=n(96533),p=n(55877),m=n.n(p),b=n(81495),h=n(1487);function y(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return v(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?v(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,o=!0,c=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){c=!0,l=e},f:function(){try{o||null==n.return||n.return()}finally{if(c)throw l}}}}function v(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var g=n(81092).newEngine;const k=function(e){var t=e.sharedProps,n=e.inactive,l=t.session,o=t.datasets,u=t.setSelectedElements,p=(t.selectedElements,t.projects),v=t.setSelectionId,k=(t.store,(0,r.useState)("\nPREFIX beo: <https://pi.pauwel.be/voc/buildingelement#>\nSELECT ?element \nWHERE {\n  ?element a beo:Door .\n}\n")),w=(0,i.Z)(k,2),E=w[0],S=w[1],x=(0,r.useState)(!1),j=(0,i.Z)(x,2),Z=(j[0],j[1],(0,r.useState)(!1)),C=(0,i.Z)(Z,2),O=(C[0],C[1],(0,r.useState)([])),q=(0,i.Z)(O,2),R=q[0],I=q[1],P=(0,r.useState)([]),T=(0,i.Z)(P,2),A=T[0],F=T[1],Q=(0,r.useState)(!1),J=(0,i.Z)(Q,2),N=(J[0],J[1],(0,r.useState)(!1)),B=(0,i.Z)(N,2),D=(B[0],B[1],(0,r.useState)(null)),z=(0,i.Z)(D,2),H=z[0],L=z[1],M=p[Object.keys(p)[0]];function U(e){var t,n=[],r=y(A);try{for(r.s();!(t=r.n()).done;){var a=t.value;if(a.checked){var l,o=y(e);try{for(o.s();!(l=o.n()).done;){var c=l.value;n.push(c[a.name].value)}}catch(e){o.e(e)}finally{o.f()}}}}catch(e){r.e(e)}finally{r.f()}return n}function V(){return(V=(0,s.Z)(d().mark((function e(t){var n,r,a,c,s,i,f,p,b,k,w,S,x,j,Z,C,O;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,u([]),I([]),n=m()(),v(n),g(),e.next=8,(0,h.getDistributionsByMediaType)(o,"text/turtle",l);case 8:if(r=e.sent,a=[],!(r.length>0)){e.next=34;break}s=y(r),e.prev=12,s.s();case 14:if((i=s.n()).done){e.next=26;break}return f=i.value,p=encodeURI(f.url+E).replaceAll("#","%23"),e.next=19,l.fetch(p).then((function(e){return e.json()}));case 19:b=e.sent,console.log("r",b),c=b.results.bindings,k=U(b.results.bindings),a.push({dataset:f.dataset,identifiers:k});case 24:e.next=14;break;case 26:e.next=31;break;case 28:e.prev=28,e.t0=e.catch(12),s.e(e.t0);case 31:return e.prev=31,s.f(),e.finish(31);case 34:return I(c),console.log("JSON.stringify({selection: result})",JSON.stringify({selection:a})),w=[],e.next=39,(0,h.findReferenceEndpoints)(M,l);case 39:S=e.sent,x=y(S),e.prev=41,x.s();case 43:if((j=x.n()).done){e.next=52;break}return Z=j.value,C={headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({selection:a})},e.next=48,l.fetch(Z,C).then((function(e){return e.json()}));case 48:O=e.sent,w.push(O);case 50:e.next=43;break;case 52:e.next=57;break;case 54:e.prev=54,e.t1=e.catch(41),x.e(e.t1);case 57:return e.prev=57,x.f(),e.finish(57);case 60:u(w.flat()),e.next=66;break;case 63:e.prev=63,e.t2=e.catch(0),console.log("error in query - queryProject",e.t2);case 66:case"end":return e.stop()}}),e,null,[[0,63],[12,28,31,34],[41,54,57,60]])})))).apply(this,arguments)}return(0,r.useEffect)((function(){try{A.filter((function(e){return e.checked})).map((function(e){return e.name}));var e=(0,b.translate)(E);L(null),F(e.variables.map((function(e){return{name:e.value,checked:!0}})))}catch(e){L(e.message)}}),[E]),n?a().createElement(a().Fragment,null):a().createElement("div",{style:{margin:20}},a().createElement("h3",null,"Project Query"),a().createElement("div",null,a().createElement(f.TextField,{id:"standard-multiline-flexible",label:"Query",fullWidth:!0,multiline:!0,onChange:function(e){S(e.target.value)},value:E,helperText:H,error:H}),a().createElement("h3",null,"Variables to visualize"),a().createElement(f.FormGroup,null,A.map((function(e){return a().createElement(f.FormControlLabel,{key:e.name,control:a().createElement(f.Checkbox,{checked:e.checked,onChange:function(t){var n=A.filter((function(t){return t.name!==e.name}));F([].concat((0,c.Z)(n),[{name:e.name,checked:!e.checked}]))},name:"checkedB",color:"primary"}),label:e.name})}))),a().createElement(f.Button,{variant:"contained",color:"primary",onClick:function(){return function(e){return V.apply(this,arguments)}()}},"Query"),a().createElement("ul",{style:{overflowY:"scroll",maxHeight:500,fontSize:12}},R.map((function(e,t){return a().createElement("li",{key:t},JSON.stringify(e))})))))};var w=n(24853),E=n(75073),S=n(81344),x=((0,w.atom)({key:"session",default:new E.Session}),(0,w.atom)({key:"projects",default:["http://localhost:5000/jeroen/lbd/f65db6eb-fc13-4ee7-955a-cf93fdf29d5b/"]})),j=(0,w.atom)({key:"datasets",default:[{main:"https://pod.lbdserver.org/jeroen/lbd/f65db6eb-fc13-4ee7-955a-cf93fdf29d5b/architectural_duplex.ttl",metadata:"https://pod.lbdserver.org/jeroen/lbd/f65db6eb-fc13-4ee7-955a-cf93fdf29d5b/architectural_duplex.ttl.props.ttl"}]}),Z=(0,w.atom)({key:"selectedElements",default:[]}),C=(0,w.atom)({key:"selectionId",default:""}),O=(0,w.atom)({key:"trigger",default:"0"}),q=(0,w.atom)({key:"store",default:new S.Store}),R=n(60698),I=n(89875),P=n(97581),T=n(60306),A=n(60306),F=function(e,t,n){var r;if(n)r=a().createElement(n,null);else{var l={};t&&(l=t),r=a().createElement(k,l)}o().render(r,e)},Q=document.querySelector("#"+A.name);Q&&F(Q,{},(function(){var e={url:T.domain,scope:T.name,label:T.name,module:"./index",dimensions:{x:0,y:0,h:850,w:400}},t=function(e,t){return function(){var n=(0,r.useState)(!0),l=(0,i.Z)(n,2),o=l[0],c=l[1],s=(0,w.useRecoilState)(j),u=(0,i.Z)(s,2),d=u[0],p=u[1],m=(0,w.useRecoilState)(Z),b=(0,i.Z)(m,2),h=b[0],y=b[1],v=(0,w.useRecoilState)(x),g=(0,i.Z)(v,2),k=g[0],E=g[1],S=(0,w.useRecoilState)(C),R=(0,i.Z)(S,2),T=R[0],A=R[1],F=(0,w.useRecoilState)(O),Q=(0,i.Z)(F,2),J=Q[0],N=Q[1],B=(0,w.useRecoilValue)(q),D={projects:k,setProjects:E,datasets:d,setDatasets:p,selectedElements:h,setSelectedElements:y,selectionId:T,setSelectionId:A,trigger:J,setTrigger:N,store:B};return a().createElement("div",null,a().createElement(f.IconButton,{style:{position:"absolute",right:o?450:0},variant:"contained",color:"primary",onClick:function(){return c(!o)}},o?a().createElement(a().Fragment,null):a().createElement(I.default,null)),a().createElement(P.Options,{openOptions:o,setOpenOptions:c,trigger:J,setTrigger:N,projects:k,setProjects:E,store:B})," ",a().createElement(e,{sharedProps:D,module:t,children:null,inactive:!1}))}}(k,e);return a().createElement("div",{style:{width:e.dimensions.w,height:e.dimensions.h}},a().createElement(w.RecoilRoot,null,a().createElement(R.QueryClientProvider,{client:new R.QueryClient},a().createElement(t,{module:e}))))}));const J=F},60306:e=>{"use strict";e.exports=JSON.parse('{"name":"projectquery","version":"1.0.0","port":8083,"domain":"https://consolidproject.github.io/pluginQuery/","scripts":{"start":"webpack serve --config config/webpack.dev.js","build:dev":"webpack --config config/webpack.dev.js","build":"webpack --config config/webpack.prod.js"},"dependencies":{"@comunica/actor-init-sparql":"^1.22.0","@frogcat/ttl2jsonld":"0.0.6","@inrupt/solid-client-authn-browser":"^1.11.2","@ldflex/comunica":"^3.4.2","@material-ui/core":"^4.11.0","@material-ui/icons":"^4.9.1","@solid/query-ldflex":"^2.11.3","assert":"^2.0.0","browserify-fs":"^1.0.0","browserify-zlib":"^0.2.0","buffer":"^6.0.3","consolid-react-ui":"0.0.10","crypto-browserify":"^3.12.0","events":"^3.3.0","graphql-ld":"^1.2.0","graphql-ld-comunica-solid":"^1.0.1","https-browserify":"^1.0.0","ldflex":"^2.12.1","mem":"^9.0.0","n3":"^1.10.0","os-browserify":"^0.3.0","path":"^0.12.7","path-browserify":"^1.0.1","process":"^0.11.10","react":"^17.0.1","react-bootstrap":"^1.6.0","react-dom":"^17.0.1","react-query":"^3.24.4","react-router-dom":"^5.2.0","recoil":"^0.4.1","source-map-loader":"^3.0.0","sparqlalgebrajs":"^3.0.2","stream-browserify":"^3.0.0","stream-http":"^3.2.0","util":"^0.12.4"},"devDependencies":{"@babel/core":"^7.12.3","@babel/plugin-transform-runtime":"^7.12.1","@babel/preset-env":"^7.12.1","@babel/preset-react":"^7.12.1","babel-loader":"^8.1.0","clean-webpack-plugin":"^3.0.0","css-loader":"^5.0.0","html-webpack-plugin":"^4.5.0","style-loader":"^2.0.0","webpack":"^5.4.0","webpack-cli":"^4.7.0","webpack-dev-server":"^3.11.2","webpack-merge":"^5.2.0"}}')}}]);