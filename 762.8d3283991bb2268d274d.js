(self.webpackChunkprojectquery=self.webpackChunkprojectquery||[]).push([[762],{31762:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>H});var n=r(77865),a=r.n(n),c=r(21704),o=r.n(c),l=r(85061),s=r(92137),i=r(28481),u=r(87757),d=r.n(u),f=r(96533),p=r(55877),b=r.n(p),m=r(81495),h=r(64103);function v(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return y(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?y(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var c,o=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){l=!0,c=e},f:function(){try{o||null==r.return||r.return()}finally{if(l)throw c}}}}function y(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}var g=r(81092).newEngine;const k=function(e){var t=e.sharedProps,r=e.inactive,c=t.session,o=t.datasets,u=t.setSelectedElements,p=(t.selectedElements,t.projects),y=t.setSelectionId,k=(t.store,(0,n.useState)("\nPREFIX beo: <https://pi.pauwel.be/voc/buildingelement#>\nSELECT ?element \nWHERE {\n  ?element a beo:Door .\n}\n")),j=(0,i.Z)(k,2),E=j[0],w=j[1],x=(0,n.useState)(!1),S=(0,i.Z)(x,2),q=(S[0],S[1],(0,n.useState)(!1)),R=(0,i.Z)(q,2),Z=(R[0],R[1],(0,n.useState)([])),C=(0,i.Z)(Z,2),P=C[0],_=C[1],O=(0,n.useState)([]),I=(0,i.Z)(O,2),T=I[0],M=I[1],A=(0,n.useState)(!1),H=(0,i.Z)(A,2),F=(H[0],H[1],(0,n.useState)(!1)),L=(0,i.Z)(F,2),Q=(L[0],L[1],(0,n.useState)(null)),X=(0,i.Z)(Q,2),D=X[0],J=X[1],V=p[Object.keys(p)[0]];function B(e){var t,r=[],n=v(T);try{for(n.s();!(t=n.n()).done;){var a=t.value;if(a.checked){var c,o=v(e);try{for(o.s();!(c=o.n()).done;){var l=c.value;r.push(l[a.name].value)}}catch(e){o.e(e)}finally{o.f()}}}}catch(e){n.e(e)}finally{n.f()}return r}function z(){return(z=(0,s.Z)(d().mark((function e(t){var r,n,a,l,s,i,f,p,m,k,j,w,x,S,q,R,Z,C,P,O,I,T;return d().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("query project"),u([]),_([]),r=b()(),y(r),g(),e.next=9,(0,h.getDistributionsByMediaType)(o,["text/turtle"],c);case 9:if(n=e.sent,a=[],!(n.length>0)){e.next=36;break}s=v(n),e.prev=13,s.s();case 15:if((i=s.n()).done){e.next=28;break}return f=i.value,p=encodeURI(f.url+E).replaceAll("#","%23"),console.log("url",p),e.next=21,c.fetch(p).then((function(e){return e.json()}));case 21:m=e.sent,console.log("r",m),l=m.results.bindings,k=B(m.results.bindings),a.push({dataset:f.dataset,identifiers:k});case 26:e.next=15;break;case 28:e.next=33;break;case 30:e.prev=30,e.t0=e.catch(13),s.e(e.t0);case 33:return e.prev=33,s.f(),e.finish(33);case 36:return _(l),j=[],e.next=40,(0,h.getLdpMembers)(V,c);case 40:return w=e.sent,e.next=43,(0,h.findReferenceEndpoints)(w,c);case 43:x=e.sent,console.log("references",x),S=v(x),e.prev=46,S.s();case 48:if((q=S.n()).done){e.next=79;break}return R=q.value,Z={headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify({selection:a})},e.next=53,c.fetch(R+"/storage/query",Z).then((function(e){return e.json()}));case 53:if(!((C=e.sent).length>0&&C[0].alias)){e.next=76;break}P=v(C[0].alias),e.prev=56,P.s();case 58:if((O=P.n()).done){e.next=68;break}return I=O.value,console.log("a",I),e.next=63,c.fetch(I).then((function(e){return e.json()}));case 63:T=e.sent,console.log("alias",T),j.push(T);case 66:e.next=58;break;case 68:e.next=73;break;case 70:e.prev=70,e.t1=e.catch(56),P.e(e.t1);case 73:return e.prev=73,P.f(),e.finish(73);case 76:j.push(C);case 77:e.next=48;break;case 79:e.next=84;break;case 81:e.prev=81,e.t2=e.catch(46),S.e(e.t2);case 84:return e.prev=84,S.f(),e.finish(84);case 87:u(j.flat()),e.next=93;break;case 90:e.prev=90,e.t3=e.catch(0),console.log("error in query - queryProject",e.t3);case 93:case"end":return e.stop()}}),e,null,[[0,90],[13,30,33,36],[46,81,84,87],[56,70,73,76]])})))).apply(this,arguments)}return(0,n.useEffect)((function(){try{T.filter((function(e){return e.checked})).map((function(e){return e.name}));var e=(0,m.translate)(E);J(null),M(e.variables.map((function(e){return{name:e.value,checked:!0}})))}catch(e){J(e.message)}}),[E]),r?a().createElement(a().Fragment,null):a().createElement("div",{style:{margin:20}},a().createElement("h3",null,"Project Query"),a().createElement("div",null,a().createElement(f.TextField,{id:"standard-multiline-flexible",label:"Query",fullWidth:!0,multiline:!0,onChange:function(e){w(e.target.value)},value:E,helperText:D,error:D}),a().createElement("h3",null,"Variables to visualize"),a().createElement(f.FormGroup,null,T.map((function(e){return a().createElement(f.FormControlLabel,{key:e.name,control:a().createElement(f.Checkbox,{checked:e.checked,onChange:function(t){var r=T.filter((function(t){return t.name!==e.name}));M([].concat((0,l.Z)(r),[{name:e.name,checked:!e.checked}]))},name:"checkedB",color:"primary"}),label:e.name})}))),a().createElement(f.Button,{variant:"contained",color:"primary",onClick:function(){return function(e){return z.apply(this,arguments)}()}},"Query"),a().createElement("ul",{style:{overflowY:"scroll",maxHeight:500,fontSize:12}},P.map((function(e,t){return a().createElement("li",{key:t},JSON.stringify(e))})))))};var j=r(24853),E=r(75073),w=r(81344),x=((0,j.atom)({key:"session",default:new E.Session}),(0,j.atom)({key:"projects",default:["http://localhost:5000/jeroen/lbd/f65db6eb-fc13-4ee7-955a-cf93fdf29d5b/"]})),S=(0,j.atom)({key:"datasets",default:[{main:"https://pod.lbdserver.org/jeroen/lbd/f65db6eb-fc13-4ee7-955a-cf93fdf29d5b/architectural_duplex.ttl",metadata:"https://pod.lbdserver.org/jeroen/lbd/f65db6eb-fc13-4ee7-955a-cf93fdf29d5b/architectural_duplex.ttl.props.ttl"}]}),q=(0,j.atom)({key:"selectedElements",default:[{_id:"61af9a6d4c65ec4c9e96d6fe",project:"http://localhost:5000/arch/lbd/testproject",url:"http://localhost:5001/reference/thing_798b91c9-4bba-49a8-b9a6-e98cecde673b",alias:[],references:[{_id:"61af9a6d4c65ec4c9e96d700",project:"http://localhost:5000/arch/lbd/testproject",dataset:"http://localhost:5000/arch/lbd/testproject/local/datasets/b8MbRixj5xu3H2HPX7rRe8/",distribution:"http://localhost:5000/arch/lbd/testproject/local/datasets/b8MbRixj5xu3H2HPX7rRe8/7v3TaEP9Fuq6swVkqSksue",id:"1CZILmCaHETO8tf3SgGEXu",alias:[],thing:"61af9a6d4c65ec4c9e96d6fe",__v:0},{_id:"61af9a6d4c65ec4c9e96d705",project:"http://localhost:5000/arch/lbd/testproject",dataset:"http://localhost:5000/arch/lbd/testproject/local/datasets/g5MboPMAhymJ48efrsVew3/",distribution:"http://localhost:5000/arch/lbd/testproject/local/datasets/g5MboPMAhymJ48efrsVew3/4qeHxS4DXM5hRLEX7pLCrW",id:"https://lbdserver.org/projects/642f0417-ce23-4d9d-8806-c078aed93ae1/slab_4c8d2570-3244-4e75-8237-a4372a40e878",alias:[],thing:"61af9a6d4c65ec4c9e96d6fe",__v:0}],__v:1}]}),R=(0,j.atom)({key:"selectionId",default:""}),Z=(0,j.atom)({key:"trigger",default:"0"}),C=(0,j.atom)({key:"store",default:new w.Store}),P=r(60698),_=r(89875),O=r(97581),I=r(60306),T=r(60306),M=function(e,t,r){var n;if(r)n=a().createElement(r,null);else{var c={};t&&(c=t),n=a().createElement(k,c)}o().render(n,e)},A=document.querySelector("#"+T.name);A&&M(A,{},(function(){var e={url:I.domain,scope:I.name,label:I.name,module:"./index",dimensions:{x:0,y:0,h:850,w:400}},t=function(e,t){return function(){var r=(0,n.useState)(!0),c=(0,i.Z)(r,2),o=c[0],l=c[1],s=(0,j.useRecoilState)(S),u=(0,i.Z)(s,2),d=u[0],p=u[1],b=(0,j.useRecoilState)(q),m=(0,i.Z)(b,2),h=m[0],v=m[1],y=(0,j.useRecoilState)(x),g=(0,i.Z)(y,2),k=g[0],E=g[1],w=(0,j.useRecoilState)(R),P=(0,i.Z)(w,2),I=P[0],T=P[1],M=(0,j.useRecoilState)(Z),A=(0,i.Z)(M,2),H=A[0],F=A[1],L=(0,j.useRecoilValue)(C),Q={projects:k,setProjects:E,datasets:d,setDatasets:p,selectedElements:h,setSelectedElements:v,selectionId:I,setSelectionId:T,trigger:H,setTrigger:F,store:L};return a().createElement("div",null,a().createElement(f.IconButton,{style:{position:"absolute",right:o?450:0},variant:"contained",color:"primary",onClick:function(){return l(!o)}},o?a().createElement(a().Fragment,null):a().createElement(_.default,null)),a().createElement(O.Options,{openOptions:o,setOpenOptions:l,trigger:H,setTrigger:F,projects:k,setProjects:E,store:L})," ",a().createElement(e,{sharedProps:Q,module:t,children:null,inactive:!1}))}}(k,e);return a().createElement("div",{style:{width:e.dimensions.w,height:e.dimensions.h}},a().createElement(j.RecoilRoot,null,a().createElement(P.QueryClientProvider,{client:new P.QueryClient},a().createElement(t,{module:e}))))}));const H=M},60306:e=>{"use strict";e.exports=JSON.parse('{"name":"projectquery","version":"1.0.0","port":8083,"domain":"https://consolidproject.github.io/pluginQuery/","scripts":{"start":"webpack serve --config config/webpack.dev.js","build:dev":"webpack --config config/webpack.dev.js","build":"webpack --config config/webpack.prod.js"},"dependencies":{"@comunica/actor-init-sparql":"^1.22.0","@frogcat/ttl2jsonld":"0.0.6","@inrupt/solid-client-authn-browser":"^1.11.2","@ldflex/comunica":"^3.4.2","@material-ui/core":"^4.11.0","@material-ui/icons":"^4.9.1","@solid/query-ldflex":"^2.11.3","assert":"^2.0.0","browserify-fs":"^1.0.0","browserify-zlib":"^0.2.0","buffer":"^6.0.3","consolid":"^1.1.0","consolid-react-ui":"0.0.10","crypto-browserify":"^3.12.0","events":"^3.3.0","graphql-ld":"^1.2.0","graphql-ld-comunica-solid":"^1.0.1","https-browserify":"^1.0.0","ldflex":"^2.12.1","mem":"^9.0.0","n3":"^1.10.0","os-browserify":"^0.3.0","path":"^0.12.7","path-browserify":"^1.0.1","process":"^0.11.10","react":"^17.0.1","react-bootstrap":"^1.6.0","react-dom":"^17.0.1","react-query":"^3.24.4","react-router-dom":"^5.2.0","recoil":"^0.4.1","source-map-loader":"^3.0.0","sparqlalgebrajs":"^3.0.2","stream-browserify":"^3.0.0","stream-http":"^3.2.0","util":"^0.12.4"},"devDependencies":{"@babel/core":"^7.12.3","@babel/plugin-transform-runtime":"^7.12.1","@babel/preset-env":"^7.12.1","@babel/preset-react":"^7.12.1","babel-loader":"^8.1.0","clean-webpack-plugin":"^3.0.0","css-loader":"^5.0.0","html-webpack-plugin":"^4.5.0","style-loader":"^2.0.0","webpack":"^5.4.0","webpack-cli":"^4.7.0","webpack-dev-server":"^3.11.2","webpack-merge":"^5.2.0"}}')}}]);